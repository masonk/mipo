
# We are using lld because linking is slow and lld is faster than rust's default linker
# for Windows we need to install the lld linker this way
# cargo install -f cargo-binutils
# rustup component add llvm-tools-preview
# for linux sudo apt-get install lld clang 
# for mac, the default linker is already fast

# https://bevyengine.org/learn/quick-start/getting-started/setup/#build-bevy
# https://github.com/bevyengine/bevy/blob/latest/.cargo/config_fast_builds.toml

[target.x86_64-unknown-linux-gnu]
linker = "clang"
rustflags = [
  "-Clink-arg=-fuse-ld=lld", # Use LLD Linker
  "-Zshare-generics=y",      # (Nightly) Make the current crate share its generic instantiations
  "-Zthreads=0",             # (Nightly) Use improved multithreading with the recommended amount of threads.
]

[target.x86_64-apple-darwin]
rustflags = [
  "-Zshare-generics=y",                                   # (Nightly) Make the current crate share its generic instantiations
  "-Zthreads=0",                                          # (Nightly) Use improved multithreading with the recommended amount of threads.
]

[target.aarch64-apple-darwin]
rustflags = [
  "-Zshare-generics=y",                                      # (Nightly) Make the current crate share its generic instantiations
  "-Zthreads=0",                                             # (Nightly) Use improved multithreading with the recommended amount of threads.
]

[target.x86_64-pc-windows-msvc]
linker = "rust-lld.exe" # Use LLD Linker
rustflags = [
  "-Zshare-generics=n",
  "-Zthreads=0",        # (Nightly) Use improved multithreading with the recommended amount of threads.
]

[target.wasm32-unknown-unknown]
runner = "wasm-server-runner"